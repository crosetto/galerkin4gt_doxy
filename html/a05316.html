<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Galerkin4GT: Installation instructions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Galerkin4GT
   &#160;<span id="projectnumber">0.1</span>
   </div>
   <div id="projectbrief">Contributive effort to implement proof-of-concept Galerkin methods on new HPC architectures</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('a05316.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Installation instructions </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Clone the GridTools repo at a specific revision </p><div class="fragment"><div class="line">cd ${HOME}</div><div class="line">git clone https:<span class="comment">//github.com/GridTools/gridtools.git</span></div><div class="line">cd <a class="code" href="a03205.html">gridtools</a></div><div class="line">git checkout galerkin4gt_010</div></div><!-- fragment --><h2>Install gridtools </h2>
<p>You need the Boost third party library </p><div class="fragment"><div class="line">mkdir build</div><div class="line">cd build</div><div class="line">cmake \</div><div class="line">-DCMAKE_INSTALL_PREFIX:PATH=${HOME}/local/GridTools \</div><div class="line">-DCMAKE_BUILD_TYPE=RELEASE \</div><div class="line">-DUSE_GPU:BOOL=ON \</div><div class="line">-DCUDA_ARCH:STRING=<span class="stringliteral">&quot;sm_35&quot;</span> \</div><div class="line">-DUSE_MPI:BOOL=OFF \</div><div class="line">-DSINGLE_PRECISION:BOOL=OFF \</div><div class="line">-DENABLE_CXX11:BOOL=ON \</div><div class="line">-DENABLE_PYTHON:BOOL=OFF \</div><div class="line">-DENABLE_PERFORMANCE_METERS:BOOL=ON \</div><div class="line">-DSTRUCTURED_GRIDS=ON \</div><div class="line">..</div><div class="line"></div><div class="line">make</div><div class="line">make install</div></div><!-- fragment --><p> In this example we are installing GridTools without MPI support, with GPU, double precision and on structured grids</p>
<p>Available options are summarized in the following table: </p><a class="anchor" id="gt_features"></a>
<table class="doxtable">
<caption>Syntax </caption>
<tr>
<th>Option </th><th>description </th><th>default </th></tr>
<tr>
<td>STRUCTURED_GRIDS </td><td>wether we the grid is structured </td><td>OFF </td></tr>
<tr>
<td>VERBOSE </td><td>print debug information during runtime </td><td>OFF </td></tr>
<tr>
<td>ENABLE_CXX11 </td><td>C++11 support </td><td>ON </td></tr>
<tr>
<td>GNU_COVERAGE </td><td>enabled gcov instrumentation </td><td>OFF </td></tr>
<tr>
<td>GNU_PROFILE </td><td>enabled gprof instrumentation </td><td>OFF </td></tr>
<tr>
<td>ENABLE_PERFORMANCE_METERS </td><td>prints out timings </td><td>OFF </td></tr>
<tr>
<td>PAPI_WRAP_LIBRARY </td><td>use PAPI_WRAP, a library wrapping PAPI counters </td><td>OFF </td></tr>
<tr>
<td>USE_PAPI </td><td>use PAPI counters </td><td>OFF </td></tr>
<tr>
<td>SINGLE_PRECISION </td><td>compile for single or double precision </td><td>OFF </td></tr>
<tr>
<td>USE_MPI </td><td>enables the compilation of GCL (Generic Communication Layer) and MPI </td><td>OFF </td></tr>
<tr>
<td>ENABLE_PYTHON </td><td>Enabled the python interface for rapid prototyping </td><td>OFF </td></tr>
<tr>
<td>USE_GPU </td><td>Enables CUDA targets, defines CUDA_VERSION, CUDA_VERSION_MAJOR, CUDA_VERSION_MINOR </td><td>OFF </td></tr>
</table>
<h2>Optional: install Xdmf and HDF5 </h2>
<p>This part is optional. HDF5 is a general purpose parallel binary file format. Xdmf is an XML format to describe the output results (which may be stored in binary format, e.g. HDF5).</p>
<p>The HDF5 API has undergone some changes, and they were not always reflected in the Xdmf API. The current instructions refer to the version 1.10 for HDF5, and the last version from Xdmf2 Git repository (i.e. version 2.0 for Xdmf). Download the latest versions of Xdmf and HDF5.</p>
<p>Compile HDF5: go to the source directory and run the command </p><div class="fragment"><div class="line">mkdir build</div><div class="line">cd build</div><div class="line">cmake -DCMAKE_INSTALL_PREFIX=${HOME}/local/hdf5 ..</div><div class="line">make install</div></div><!-- fragment --><p> For simplicity we show how to install HDF5 without the support for parallel I/O.</p>
<p>Then go to the Xdmf source directory. At the time of writing there is an inconsistency with the CMakeFiles.txt contained in the Xdmf2 sources and the FindHDF5.cmake module in CMake. The problem is that FindCuda.cmake defines a variable named "HDF5_INCLUDE_DIR", while Xdmf2 expects a variable with name "HDF5_INCLUDE_DIRS", with an extra 'S'. The fix is easy: just open the file CMakeLists.txt in the Xdmf2 sources and replace the following lines </p><div class="fragment"><div class="line">-find_package(HDF5 REQUIRED)</div><div class="line">+find_package(HDF5 REQUIRED HINTS ${HDF5_ROOT}/share/cmake)</div><div class="line">-  include_directories(${HDF5_INCLUDE_DIRS})</div><div class="line">+  include_directories(${HDF5_INCLUDE_DIR})</div></div><!-- fragment --><p> Now you should be able to compile Xdmf2 using the following commands (note that you need also libxml2 as a dependency) </p><div class="fragment"><div class="line">mkdir build</div><div class="line">cd build</div><div class="line">cmake -DCMAKE_INSTALL_PREFIX=~/local/xdmf -DBUILD_SHARED_LIBS=1 -DXDMF_WRAP_PYTHON=0 -DHDF5_ROOT=~/local/hdf5 -Wno-dev ..</div><div class="line">make install</div></div><!-- fragment --><p> This installs Xdmf without python support, and with the HDF5 from our local path.</p>
<h2>Install Galerkin4GT </h2>
<p>We proceed with the compilation of the examples in the galerkin4gt repo: </p><div class="fragment"><div class="line">cd ${HOME}</div><div class="line">git clone https:<span class="comment">//github.com/eth-cscs/galerkin4gt.git</span></div><div class="line">cd galerkin4gt</div></div><!-- fragment --><p>For the configuration we need some libraries from Trilinos installed, namely Intrepid, Teuchos and Kokkos, and the blas and lapack libraries. There is also an optional Xdmf dependency for i/o. </p><div class="fragment"><div class="line">cmake \</div><div class="line">-DGRIDTOOLS_ROOT:PATH=${HOME}/local/GridTools \</div><div class="line">-DCMAKE_BUILD_TYPE=RELEASE \</div><div class="line">-DENABLE_NVCC_OUTPUT:BOOL=OFF \</div><div class="line">-DENABLE_XDMF:BOOL=OFF \</div><div class="line">-DENABLE_INTREPID:BOOL=ON \</div><div class="line">-DINTREPID_SOURCE_DIR:PATH=/users/crosetto/local/publicTrilinos/include \</div><div class="line">-DINTREPID_LIB_DIR:PATH=/users/crosetto/local/publicTrilinos/lib \</div><div class="line">-DBLAS_HARDCODED_LIB:STRING=<span class="stringliteral">&quot;-L${BLASDIR};-lblas;-lgfortran&quot;</span> \</div><div class="line">-DLAPACK_HARDCODED_LIB:STRING=<span class="stringliteral">&quot;-L${LAPACK_DIR};-llapack&quot;</span> \</div><div class="line">~/src/GridTools/galerkin4gt</div></div><!-- fragment --><p>compile: </p><div class="fragment"><div class="line">make</div></div><!-- fragment --><p>Note if the CMake variable ENABLE_NVCC_OUTPUT is set to false (the default value) all the messages NVCC prints are not displayed. The reason for such flag is that nvcc prints tons of nonrelevant warnings which cannot be filtered out by compiler flags. If you want to see the actual errors (together with the tons of warnings) set the ENABLE_NVCC_OUTPUT flag to ON, and recompile only the target which is failing.</p>
<p>Available options are summarized in the following table: </p><a class="anchor" id="galerkin4gt_features"></a>
<table class="doxtable">
<caption>Syntax </caption>
<tr>
<th>Option </th><th>description </th><th>default </th></tr>
<tr>
<td>ENABLE_NVCC_OUTPUT </td><td>if set to OFF redirects to /dev/null the output of nvcc </td><td>OFF </td></tr>
<tr>
<td>ENABLE_XDMF </td><td>looks for Xdmf library, to dave output files in hdf5 format </td><td>OFF </td></tr>
<tr>
<td>XDMF_ROOT </td><td>set this variable to the path of the Xdmf root installation when the library is not automatically found </td><td>OFF </td></tr>
<tr>
<td>XDMF_LIBS (XDMF_INCLUDE_DIRS) </td><td>set this variable to the path of the Xdmf libs (include dirs) when it is not found automatically </td><td><p class="starttd">OFF</p>
<p class="endtd"></p>
</td></tr>
<tr>
<td>ENABLE_INTREPID </td><td>Set this variable to ON if you use Intrepid for the discretizaiton (the only option so far) </td><td>ON </td></tr>
<tr>
<td>INTREPID_SOURCE_DIR </td><td>set this to point to the intrepid sources directory. All other required Trilinos headers will be looked up based on this path </td><td>OFF </td></tr>
<tr>
<td>INTREPID_LIB_DIR </td><td>set this to point to the intrepid library directory. All other required Trilinos library will be looked up based on this path </td><td>OFF </td></tr>
<tr>
<td>BLAS_HARDCODED_LIB </td><td>The library tries to find Blas automatically. If it fails, set this to the name with full path of the blas library (or to <code>-L&lt;path&gt;;-lblas</code>). </td><td>N/A </td></tr>
<tr>
<td>LAPACK_HARDCODED_LIB </td><td>same as above, but for lapack </td><td>N/A </td></tr>
</table>
</div></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Mon Apr 3 2017 09:46:56 for Galerkin4GT by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
